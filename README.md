# Hsu.Daemon

[![dev](https://github.com/hsu-net/daemon/actions/workflows/build.yml/badge.svg?branch=dev)](https://github.com/hsu-net/daemon/actions/workflows/build.yml)
[![preview](https://github.com/hsu-net/daemon/actions/workflows/deploy.yml/badge.svg?branch=preview)](https://github.com/hsu-net/daemon/actions/workflows/deploy.yml)
[![main](https://github.com/hsu-net/daemon/actions/workflows/deploy.yml/badge.svg?branch=main)](https://github.com/hsu-net/daemon/actions/workflows/deploy.yml)
[![nuke build](https://img.shields.io/badge/nuke-build-yellow.svg)](https://github.com/nuke-build/nuke)
![windows](https://img.shields.io/badge/OS-Windows-blue.svg)
![linux](https://img.shields.io/badge/OS-Linux-blue.svg)


## Package Version

| Name | Source | Stable | Preview |
|---|---|---|---|
| Hsu.Daemon.Abstractions | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Abstractions?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Abstractions) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Abstractions?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Abstractions) |
| Hsu.Daemon.Abstractions | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Abstractions?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Abstractions) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Abstractions?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Abstractions) |
| Hsu.Daemon.Cli | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Cli?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Cli) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Cli?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Cli) |
| Hsu.Daemon.Cli | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Cli?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Cli) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Cli?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Cli) |
| Hsu.Daemon.Windows| Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Windows?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Windows) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Windows?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Windows) |
| Hsu.Daemon.Windows| MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Windows?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Windows) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Windows?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Windows) |
| Hsu.Daemon.Systemd | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Systemd?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Systemd) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Systemd?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Systemd) |
| Hsu.Daemon.Systemd | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Systemd?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Systemd) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Systemd?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Systemd) |
| Hsu.Daemon.Hosting | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Hosting?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Hosting) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Hosting?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Hosting) |
| Hsu.Daemon.Hosting | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Hosting?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Hosting) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Hosting?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Hosting) |
| Hsu.Daemon.Hosting.Web | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Hosting.Web?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Hosting.Web) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Hosting.Web?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Hosting.Web) |
| Hsu.Daemon.Hosting.Web | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Hosting.Web?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Hosting.Web) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Hosting.Web?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Hosting.Web) |
| Hsu.Daemon.Template | Nuget | [![NuGet](https://img.shields.io/nuget/v/Hsu.Daemon.Template?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Template) | [![NuGet](https://img.shields.io/nuget/vpre/Hsu.Daemon.Template?style=flat-square)](https://www.nuget.org/packages/Hsu.Daemon.Template) |
| Hsu.Daemon.Template | MyGet | [![MyGet](https://img.shields.io/myget/godsharp/v/Hsu.Daemon.Template?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Template) | [![MyGet](https://img.shields.io/myget/godsharp/vpre/Hsu.Daemon.Template?style=flat-square&label=myget)](https://www.myget.org/feed/godsharp/package/nuget/Hsu.Daemon.Template) |

> - Web : Used for `IWebHost`.

## Getting Started

### Self Commands

  ```bash
  # windows
  appName.exe --help
  # Linux
  dotnet appName.dll --help
  ```

### Windows Service(.NET Framework)

  ```ps
  PM> Install-Package Hsu.Daemon.Cli
  PM> Install-Package Hsu.Daemon.Windows
  ```

  ```csharp
  var daemond = Daemond.CreateBuilder(args).UseWindowsServices().Build();
  if (!daemond.Runnable()) return;
  daemond
    .Configure(x => x
        .OnStart(OnStart)
        .OnStop(OnStop)
    )
    .Run();
  ```
### Worker Service


  ```ps
  PM> Install-Package Hsu.Daemon.Cli
  PM> Install-Package Hsu.Daemon.Windows
  PM> Install-Package Hsu.Daemon.Systemd
  PM> Install-Package Hsu.Daemon.Hosting
  ```

  ```csharp
  // 1. To parser arguments 
  var daemond = Daemond.CreateBuilder(args).UseWindowsServices().Build();
  if (!daemond.Runnable()) return;
  var builder = Host.CreateDefaultBuilder(args);
  
  // 2. Use middleware
  // builder.UseWindowsService();
  // or
  // builder.UseSystemd();

  // 3. Execute serving or console
  builder.Build().Run(daemond.Code);
  ```

## License

  MIT